apiVersion: v2
name: microservices-platform
description: Complete microservices platform with messaging, databases, and caching
type: application
version: 2.0.0
appVersion: "2.0.0"

# Complex dependencies - Multiple services
dependencies:
  # Databases
  - name: postgresql
    version: 12.1.5
    repository: https://charts.bitnami.com/bitnami
    condition: postgresql.enabled
    tags:
      - database

  - name: mongodb
    version: 13.15.1
    repository: https://charts.bitnami.com/bitnami
    condition: mongodb.enabled
    tags:
      - database
      - nosql

  #Caching and Message Queue
  - name: redis
    version: 17.3.7
    repository: https://charts.bitnami.com/bitnami
    condition: redis.enabled
    tags:
      - cache

  - name: rabbitmq
    version: 12.5.6
    repository: https://charts.bitnami.com/bitnami
    condition: rabbitmq.enabled
    tags:
      - messaging

  - name: kafka
    version: 25.1.0
    repository: https://charts.bitnami.com/bitnami
    condition: kafka.enabled
    tags:
      - messaging
      - streaming

  # Service Mesh
  - name: istio-base
    version: 1.19.0
    repository: https://istio-release.storage.googleapis.com/charts
    condition: istio.enabled
    tags:
      - service-mesh

maintainers:
  - name: Platform Team
    email: platform@obsy.io

keywords:
  - microservices
  - platform
  - postgresql
  - mongodb
  - redis
  - rabbitmq
  - kafka
  - istio

# CloudWave update policies - Production workload
annotations:
  # Conservative defaults for production
  cloudwave.io/update-policy: "latest-2"

  # Critical databases: very conservative
  cloudwave.io/postgresql-policy: "latest-2"
  cloudwave.io/mongodb-policy: "latest-2"

  # Cache can be more current
  cloudwave.io/redis-policy: "latest-1"

  # Messaging: moderate updates
  cloudwave.io/rabbitmq-policy: "minor-only"
  cloudwave.io/kafka-policy: "latest-1"

  # Service mesh: only patch updates (breaking changes common)
  cloudwave.io/istio-base-policy: "patch-only"
